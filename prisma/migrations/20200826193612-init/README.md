# Migration `20200826193612-init`

This migration has been generated by Jochem De Jaeghere at 8/26/2020, 9:36:12 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "CourseMemberRole" AS ENUM ('STUDENT', 'TEACHER')

CREATE TYPE "EvaluationKind" AS ENUM ('TASK', 'TEST')

CREATE TYPE "EvaluationPartKind" AS ENUM ('BOOL', 'LETTER', 'NUMERIC')

CREATE TABLE "production"."Course" (
"id" text   NOT NULL ,
"organization" text   NOT NULL ,
"name" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "production"."CourseMember" (
"id" text   NOT NULL ,
"organization" text   NOT NULL ,
"userId" text   NOT NULL ,
"begin" timestamp(3)   NOT NULL ,
"end" timestamp(3)   ,
"role" "CourseMemberRole"  NOT NULL ,
"courseId" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "production"."Evaluation" (
"id" text   NOT NULL ,
"organization" text   NOT NULL ,
"date" timestamp(3)   NOT NULL ,
"title" text   NOT NULL ,
"description" text   ,
"kind" "EvaluationKind"  NOT NULL ,
"courseId" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "production"."EvaluationPart" (
"id" text   NOT NULL ,
"organization" text   NOT NULL ,
"date" timestamp(3)   NOT NULL ,
"title" text   NOT NULL ,
"description" text   ,
"maxScore" text   ,
"kind" "EvaluationPartKind"  NOT NULL ,
"evaluationId" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "production"."EvaluationPartResult" (
"id" text   NOT NULL ,
"organization" text   NOT NULL ,
"userId" text   NOT NULL ,
"score" text   NOT NULL ,
"evaluationPartId" text   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "production"."CourseMember" ADD FOREIGN KEY ("courseId")REFERENCES "production"."Course"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "production"."Evaluation" ADD FOREIGN KEY ("courseId")REFERENCES "production"."Course"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "production"."EvaluationPart" ADD FOREIGN KEY ("evaluationId")REFERENCES "production"."Evaluation"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "production"."EvaluationPartResult" ADD FOREIGN KEY ("evaluationPartId")REFERENCES "production"."EvaluationPart"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200826193612-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,87 @@
+generator client {
+    provider = "prisma-client-js"
+}
+
+datasource db {
+    provider = "postgresql"
+    url = "***"
+}
+
+model Course {
+    id           String @id @default(uuid())
+    organization String
+
+    name String
+
+    evaluations Evaluation[]
+    members     CourseMember[]
+}
+
+model CourseMember {
+    id           String @id @default(uuid())
+    organization String
+
+    userId String
+    begin  DateTime
+    end    DateTime?
+    role   CourseMemberRole
+
+    courseId String
+    course   Course @relation(fields: [courseId], references: [id])
+}
+
+model Evaluation {
+    id           String @id @default(uuid())
+    organization String
+
+    date        DateTime
+    title       String
+    description String?
+    kind        EvaluationKind
+
+    courseId String
+    course   Course           @relation(fields: [courseId], references: [id])
+    parts    EvaluationPart[]
+}
+
+model EvaluationPart {
+    id           String @id @default(uuid())
+    organization String
+
+    date        DateTime
+    title       String
+    description String?
+    maxScore    String?
+    kind        EvaluationPartKind
+
+    evaluationId String
+    evaluation   Evaluation             @relation(fields: [evaluationId], references: [id])
+    results      EvaluationPartResult[]
+}
+
+model EvaluationPartResult {
+    id           String @id @default(uuid())
+    organization String
+
+    userId String
+    score  String
+
+    evaluationPartId String
+    evaluationPart   EvaluationPart @relation(fields: [evaluationPartId], references: [id])
+}
+
+enum CourseMemberRole {
+    STUDENT
+    TEACHER
+}
+
+enum EvaluationKind {
+    TASK
+    TEST
+}
+
+enum EvaluationPartKind {
+    BOOL
+    LETTER
+    NUMERIC
+}
```


